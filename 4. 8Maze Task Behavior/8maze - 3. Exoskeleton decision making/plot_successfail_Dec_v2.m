function [x,y,x1,y1,datas,dataf] = plot_successfail_Dec_v2(Decisions,n,k)
% Author: James Hope, Biosensing and Biorobotics Lab, 
% Department of Mechanical Engineering, University of Minnesota
% Contact: suhasabk@umn.edu

% total number of wrong decisions
M1f = [sum(Decisions.M1D1.fail);...
      sum(Decisions.M1D2.fail);...
      sum(Decisions.M1D3.fail);...
      sum(Decisions.M1D4.fail);...
      sum(Decisions.M1D5.fail);...
      sum(Decisions.M1D6.fail);...
      sum(Decisions.M1D7.fail);...
      sum(Decisions.M1D8.fail)];
  
M2f = [sum(Decisions.M2D1.fail);...
      sum(Decisions.M2D2.fail);...
      sum(Decisions.M2D3.fail);...
      sum(Decisions.M2D4.fail);...
      sum(Decisions.M2D5.fail);...
      sum(Decisions.M2D6.fail);...
      sum(Decisions.M2D7.fail);...
      sum(Decisions.M2D8.fail)];

M3f = [sum(Decisions.M3D1.fail);...
      sum(Decisions.M3D2.fail);...
      sum(Decisions.M3D3.fail);...
      sum(Decisions.M3D4.fail);...
      sum(Decisions.M3D5.fail);...
      sum(Decisions.M3D6.fail);...
      sum(Decisions.M3D7.fail);...
      sum(Decisions.M3D8.fail)];
  
M4f = [sum(Decisions.M4D1.fail);...
      sum(Decisions.M4D2.fail);...
      sum(Decisions.M4D3.fail);...
      sum(Decisions.M4D4.fail);...
      sum(Decisions.M4D5.fail)]; 

M5f = [sum(Decisions.M5D1.fail);...
      sum(Decisions.M5D2.fail);...
      sum(Decisions.M5D3.fail);...
      sum(Decisions.M5D4.fail);...
      sum(Decisions.M5D5.fail);...
      sum(Decisions.M5D6.fail);...
      sum(Decisions.M5D7.fail);...
      sum(Decisions.M5D8.fail)];
  
M6f = [sum(Decisions.M6D1.fail);...
      sum(Decisions.M6D2.fail);...
      sum(Decisions.M6D3.fail);...
      sum(Decisions.M6D4.fail);...
      sum(Decisions.M6D5.fail);...
      sum(Decisions.M6D6.fail);...
      sum(Decisions.M6D7.fail);...
      sum(Decisions.M6D8.fail)];
  
M7f = [sum(Decisions.M7D1.fail);...
      sum(Decisions.M7D2.fail);...
      sum(Decisions.M7D3.fail);...
      sum(Decisions.M7D4.fail);...
      sum(Decisions.M7D5.fail);...
      sum(Decisions.M7D6.fail);...
      sum(Decisions.M7D7.fail)];
  
M8f = [sum(Decisions.M8D1.fail);...
      sum(Decisions.M8D2.fail);...
      sum(Decisions.M8D3.fail);...
      sum(Decisions.M8D4.fail);...
      sum(Decisions.M8D5.fail);...
      sum(Decisions.M8D6.fail);...
      sum(Decisions.M8D7.fail);...
      sum(Decisions.M8D8.fail)];
  
  
  % number of correct decisions 
M1s = [sum(Decisions.M1D1.success);...
      sum(Decisions.M1D2.success);...
      sum(Decisions.M1D3.success);...
      sum(Decisions.M1D4.success);...
      sum(Decisions.M1D5.success);...
      sum(Decisions.M1D6.success);...
      sum(Decisions.M1D7.success);...
      sum(Decisions.M1D8.success)];
  
M2s = [sum(Decisions.M2D1.success);...
      sum(Decisions.M2D2.success);...
      sum(Decisions.M2D3.success);...
      sum(Decisions.M2D4.success);...
      sum(Decisions.M2D5.success);...
      sum(Decisions.M2D6.success);...
      sum(Decisions.M2D7.success);...
      sum(Decisions.M2D8.success)];

M3s = [sum(Decisions.M3D1.success);...
      sum(Decisions.M3D2.success);...
      sum(Decisions.M3D3.success);...
      sum(Decisions.M3D4.success);...
      sum(Decisions.M3D5.success);...
      sum(Decisions.M3D6.success);...
      sum(Decisions.M3D7.success);...
      sum(Decisions.M3D8.success)];
  
M4s = [sum(Decisions.M4D1.success);...
      sum(Decisions.M4D2.success);...
      sum(Decisions.M4D3.success);...
      sum(Decisions.M4D4.success);...
      sum(Decisions.M4D5.success)]; 
  
M5s = [sum(Decisions.M5D1.success);...
      sum(Decisions.M5D2.success);...
      sum(Decisions.M5D3.success);...
      sum(Decisions.M5D4.success);...
      sum(Decisions.M5D5.success);...
      sum(Decisions.M5D6.success);...
      sum(Decisions.M5D7.success);...
      sum(Decisions.M5D8.success)];
  
M6s = [sum(Decisions.M6D1.success);...
      sum(Decisions.M6D2.success);...
      sum(Decisions.M6D3.success);...
      sum(Decisions.M6D4.success);...
      sum(Decisions.M6D5.success);...
      sum(Decisions.M6D6.success);...
      sum(Decisions.M6D7.success);...
      sum(Decisions.M6D8.success)];
  
M7s = [sum(Decisions.M7D1.success);...
      sum(Decisions.M7D2.success);...
      sum(Decisions.M7D3.success);...
      sum(Decisions.M7D4.success);...
      sum(Decisions.M7D5.success);...
      sum(Decisions.M7D6.success);...
      sum(Decisions.M7D7.success)];
  
M8s = [sum(Decisions.M8D1.success);...
      sum(Decisions.M8D2.success);...
      sum(Decisions.M8D3.success);...
      sum(Decisions.M8D4.success);...
      sum(Decisions.M8D5.success);...
      sum(Decisions.M8D6.success);...
      sum(Decisions.M8D7.success);...
      sum(Decisions.M8D8.success)];
  
  
  % convert to % success
  
    M1p = M1s./(M1s+M1f).*100;
    M2p = M2s./(M2s+M2f).*100;
    M3p = M3s./(M3s+M3f).*100;
    M4p = M4s./(M4s+M4f).*100;
    M5p = M5s./(M5s+M5f).*100;
    M6p = M6s./(M6s+M6f).*100;
    M7p = M7s./(M7s+M7f).*100;
    M8p = M8s./(M8s+M8f).*100;



    % find trend
    x = [[1:length(M1p)],[1:length(M2p)],[1:length(M3p)],[1:length(M4p)],...
        [1:length(M5p)],[1:length(M6p)],[1:length(M7p)],[1:length(M8p)]];
    y = [M1p;M2p;M3p;M4p;M5p;M6p;M7p;M8p]';
    p = polyfit(x,y,n);
    x1 = 1:8;
    y1 = polyval(p,x1);
        
    [datap] = mean_std(M1p,M2p,M3p,M4p,M5p,M6p,M7p,M8p);
    [datas] = mean_std(M1s,M2s,M3s,M4s,M5s,M6s,M7s,M8s);
    [dataf] = mean_std(M1f,M2f,M3f,M4f,M5f,M6f,M7f,M8f);
    
    if k == 1
        figure
        hold on
        plot(M1p,'-','Color',[0.4660 0.6740 0.1880])
        plot(M2p,'-','Color',[0.4660 0.6740 0.1880])
        plot(M3p,'-','Color',[0.4660 0.6740 0.1880])
        plot(M4p,'-','Color',[0.4660 0.6740 0.1880])
        plot(M5p,'-','Color',[0.4660 0.6740 0.1880])
        plot(M6p,'-','Color',[0.4660 0.6740 0.1880])
        plot(M7p,'-','Color',[0.4660 0.6740 0.1880])
        plot(M8p,'-','Color',[0.4660 0.6740 0.1880])
        plot(x1,y1,'-','Color',[0.4660 0.6740 0.1880],'LineWidth',4)
        ylim([0 100])
        xlabel('session')
        ylabel('success rate (%)')
        hold on
        plot(x1,datap(:,1),'-','Color',[0.4660 0.6740 0.1880],'LineWidth',4)  
    elseif k == 2
        figure
        subplot(3,3,1)
        plot(M1p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
        subplot(3,3,2)
        plot(M2p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
        subplot(3,3,3)
        plot(M3p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
        subplot(3,3,4)
        plot(M4p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
        subplot(3,3,5)
        plot(M5p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
        subplot(3,3,6)
        plot(M6p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
        subplot(3,3,7)
        plot(M7p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
        subplot(3,3,8)
        plot(M8p,'-','Color',[0.4660 0.6740 0.1880]); ylim([0 100])
    end
    

       
    
    
end

